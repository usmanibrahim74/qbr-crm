(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{11:function(t,e,a){"use strict";var r={name:"Breadcrumbs"},s=a(1),o=Object(s.a)(r,(function(){var t=this.$createElement;this._self._c;return this._m(0)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("nav",{attrs:{"aria-label":"breadcrumb"}},[e("ol",{staticClass:"breadcrumb"},[e("li",{staticClass:"breadcrumb-item"},[e("a",{attrs:{href:"#"}},[this._v("Apps")])]),this._v(" "),e("li",{staticClass:"breadcrumb-item active",attrs:{"aria-current":"page"}},[this._v("Dashboard")])])])}],!1,null,"5cad8d16",null);e.a=o.exports},40:function(t,e,a){"use strict";a.r(e);var r=a(0),s=a.n(r),o=a(11),i=a(4),n=a.n(i),l=a(3),d=a(2),u=a.n(d),c=a(14),p=a.n(c);function m(t,e,a,r,s,o,i){try{var n=t[o](i),l=n.value}catch(t){return void a(t)}n.done?e(l):Promise.resolve(l).then(r,s)}function v(t){return function(){var e=this,a=arguments;return new Promise((function(r,s){var o=t.apply(e,a);function i(t){m(o,r,s,i,n,"next",t)}function n(t){m(o,r,s,i,n,"throw",t)}i(void 0)}))}}function _(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}function f(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?_(Object(a),!0).forEach((function(e){b(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function b(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var g={name:"reports",data:function(){return{report_data:null,add_group:{group_id:0,item_id:0,group_has_error:!1,item_has_error:!1,show_modal:!1},delete_modal:{show:!1,message:""},deleteTarget:{id:0,type:""},statusList:["At Risk","Need Attention","Acceptable Risk","Satisfactory"],fields:[{key:"id",label:"#",sortable:!1},{key:"group_item.name",label:"Item Name",sortable:!0},{key:"status",label:"Status",sortable:!1},{key:"notes",label:"Notes",sortable:!0},{key:"qtr",label:"QTR",sortable:!0},{key:"target_year",label:"Target Year",sortable:!0},{key:"budget",label:"Budget",sortable:!0},"actions"]}},components:{Breadcrumbs:o.a},beforeCreate:function(){var t=this.$route.params.id;this.$store.dispatch("app/fetchReport",{id:t}),this.$store.dispatch("app/fetchGroupsWithItems"),this.$store.dispatch("app/fetchCustomers")},computed:f(f({},Object(l.c)({report:"app/report",groups:"app/groups",customers:"app/customers"})),{},{availableGroups:function(){var t=this;return this.groups.filter((function(e){var a=!1;return t.report&&t.report.groups&&(a=t.report.groups.find((function(t){return t.id==e.id}))),!a||!a.id}))},groupItems:function(){var t=this,e=this.groups.find((function(e){return e.id==t.add_group.group_id}));return e?e.items:[]}}),methods:{save:function(t,e){e.action=t,this.$store.dispatch("app/save",e)},updateReportItem:p.a.debounce(function(){var t=v(s.a.mark((function t(e,a){var r,o,i,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(r=this.report_data.groups[e].report_items[a]).group_item_id=r.group_item.id,o=new u.a(f({},r)),t.next=5,o.put("/api/report/item/".concat(r.id));case 5:i=t.sent,(n=i.data).groupIndex=e,n.itemIndex=a,this.save("UPDATE_REPORT_ITEM",n);case 10:case"end":return t.stop()}}),t,this)})));return function(e,a){return t.apply(this,arguments)}}(),500),updateReport:p.a.debounce(v(s.a.mark((function t(){var e,a,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new u.a({name:this.report_data.name,customer_id:this.report_data.customer_id,date:this.report_data.date,summary:this.report_data.summary}),t.next=3,e.put("/api/report/".concat(this.report_data.id));case 3:a=t.sent,r=a.data,this.save("UPDATE_REPORT",r);case 6:case"end":return t.stop()}}),t,this)}))),500),addGroup:function(){var t=this;return v(s.a.mark((function e(){var a,r,o,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.add_group.group_has_error=!1,t.add_group.item_has_error=!1,a=!1,t.add_group.group_id||(t.add_group.group_has_error=!0,a=!0),t.add_group.group_id||(t.add_group.group_has_error=!0,a=!0),a){e.next=13;break}return r=new u.a({group_id:t.add_group.group_id,item_id:t.add_group.item_id}),e.next=9,r.post("/api/report/".concat(t.report.id,"/group"));case 9:o=e.sent,i=o.data,t.save("UPDATE_REPORT",i),t.close();case 13:case"end":return e.stop()}}),e)})))()},getStatusBadgeClass:function(t){return"Satisfactory"==t?"badge-success":"Need Attention"==t?"badge-warning":"Acceptable Risk"==t?"badge-info":"At Risk"==t?"badge-danger":void 0},getGroupItems:function(t){return this.groups.find((function(e){return e.id==t})).items},deleteItem:function(t){this.delete_modal.message="Are you sure you want to remove this group item from report?",this.delete_modal.show=!0,this.deleteTarget.target=t,this.deleteTarget.type="item"},deleteGroup:function(t){this.delete_modal.message="Are you sure you want to remove this group from report?",this.delete_modal.show=!0,this.deleteTarget.target=t,this.deleteTarget.type="group"},addGroupItem:function(t){var e=this;return v(s.a.mark((function a(){var r,o,i;return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=new u.a({group_id:t}),a.next=3,r.post("/api/report/".concat(e.report.id,"/item/add"));case 3:o=a.sent,i=o.data,e.save("UPDATE_REPORT",i);case 6:case"end":return a.stop()}}),a)})))()},close:function(){this.delete_modal.show=!1,this.add_group.show_modal=!1},removeTarget:function(){var t=this;return v(s.a.mark((function e(){var a,r,o,i,l,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.deleteTarget.target,"group"!=(r=t.deleteTarget.type)){e.next=10;break}return e.next=5,n.a.delete("/api/report/".concat(t.report_data.id,"/group/").concat(a.id));case 5:o=e.sent,i=o.data,t.save("UPDATE_REPORT",i),e.next=16;break;case 10:if("item"!=r){e.next=16;break}return e.next=13,n.a.delete("/api/report/".concat(t.report_data.id,"/item/").concat(a.id));case 13:l=e.sent,d=l.data,t.save("UPDATE_REPORT",d);case 16:t.close();case 17:case"end":return e.stop()}}),e)})))()}},watch:{report:{deep:!0,handler:function(){this.report_data=this.report}}}},h=(a(69),a(1)),y=Object(h.a)(g,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-content"},[a("div",{staticClass:"page-info"},[a("breadcrumbs"),t._v(" "),a("div",{staticClass:"page-options"},[a("b-button",{attrs:{variant:"primary"},on:{click:function(e){t.add_group.show_modal=!0}}},[t._v("Add Group")])],1)],1),t._v(" "),a("div",{staticClass:"main-wrapper"},[a("div",{staticClass:"row"},[t.report_data?a("div",{staticClass:"col-xl"},[t._m(0),t._v(" "),a("div",{staticClass:"tab-content",attrs:{id:"report-tabs"}},[a("div",{staticClass:"tab-pane fade show active",attrs:{id:"report",role:"tabpanel","aria-labelledby":"report-tab"}},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body table-responsive"},t._l(t.report_data.groups,(function(e,r){return a("div",{key:r,staticClass:"report-group"},[a("div",{staticClass:"d-flex justify-content-between"},[a("h5",{staticClass:"card-title"},[t._v(t._s(e.name))]),t._v(" "),a("div",[a("a",{staticClass:"btn btn-xs btn-danger",attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),t.deleteGroup(e)}}},[a("font-awesome-icon",{class:"mr-1",attrs:{icon:["fas","trash"]}}),t._v("Delete\n                      ")],1),t._v(" "),a("a",{staticClass:"btn btn-xs btn-primary",attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),t.addGroupItem(e.id)}}},[a("font-awesome-icon",{class:"mr-1",attrs:{icon:["fas","plus"]}}),t._v("Add\n                      ")],1)])]),t._v(" "),a("b-table",{attrs:{items:e.report_items,fields:t.fields},scopedSlots:t._u([{key:"cell(id)",fn:function(t){return[a("a",{staticClass:"edit-item text-center text-muted",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.toggleDetails(e)}}},[t.detailsShowing?a("font-awesome-icon",{attrs:{icon:["fas","minus"]}}):a("font-awesome-icon",{attrs:{icon:["fas","plus"]}})],1)]}},{key:"cell(actions)",fn:function(e){return[a("a",{staticClass:"text-muted",attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),t.deleteItem(e.item)}}},[a("font-awesome-icon",{attrs:{icon:["fas","trash"]}})],1)]}},{key:"cell(status)",fn:function(e){return[a("span",{staticClass:"badge",class:t.getStatusBadgeClass(e.item.status)},[t._v(t._s(e.item.status))])]}},{key:"row-details",fn:function(e){return[a("div",{staticClass:"row expended-table"},[a("div",{staticClass:"col-md-6"},[a("div",{staticClass:"d-flex"},[a("label",[t._v(" Item: ")]),t._v(" "),a("div",{staticClass:"table-field-wrapper"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.item.group_item,expression:"row.item.group_item"}],staticClass:"table-field",attrs:{name:""},on:{change:[function(a){var r=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(e.item,"group_item",a.target.multiple?r:r[0])},function(a){return t.updateReportItem(r,e.index)}]}},[t._l(t.getGroupItems(e.item.group_id),(function(e){return[a("option",{domProps:{value:e}},[t._v(t._s(e.name))])]}))],2)])]),t._v(" "),a("div",{staticClass:"d-flex"},[a("label",[t._v(" Status: ")]),t._v(" "),a("div",{staticClass:"table-field-wrapper"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.item.status,expression:"row.item.status"}],staticClass:"table-field",attrs:{name:""},on:{change:function(a){var r=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(e.item,"status",a.target.multiple?r:r[0])}}},[t._l(t.statusList,(function(e){return[a("option",{domProps:{value:e}},[t._v(t._s(e))])]}))],2)])]),t._v(" "),a("div",{staticClass:"d-flex"},[a("label",[t._v(" Notes: ")]),t._v(" "),a("div",{staticClass:"table-field-wrapper"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.item.notes,expression:"row.item.notes"}],staticClass:"table-field",attrs:{type:"text"},domProps:{value:e.item.notes},on:{input:function(a){a.target.composing||t.$set(e.item,"notes",a.target.value)}}})])]),t._v(" "),a("div",{staticClass:"d-flex"},[a("label",[t._v(" QTR: ")]),t._v(" "),a("div",{staticClass:"table-field-wrapper"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.item.qtr,expression:"row.item.qtr"}],staticClass:"table-field",attrs:{type:"text"},domProps:{value:e.item.qtr},on:{input:function(a){a.target.composing||t.$set(e.item,"qtr",a.target.value)}}})])]),t._v(" "),a("div",{staticClass:"d-flex"},[a("label",[t._v(" Target Year: ")]),t._v(" "),a("div",{staticClass:"table-field-wrapper"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.item.target_year,expression:"row.item.target_year"}],staticClass:"table-field",attrs:{type:"text"},domProps:{value:e.item.target_year},on:{input:function(a){a.target.composing||t.$set(e.item,"target_year",a.target.value)}}})])]),t._v(" "),a("div",{staticClass:"d-flex"},[a("label",[t._v(" Budget: ")]),t._v(" "),a("div",{staticClass:"table-field-wrapper"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.item.budget,expression:"row.item.budget"}],staticClass:"table-field",attrs:{type:"text"},domProps:{value:e.item.budget},on:{input:function(a){a.target.composing||t.$set(e.item,"budget",a.target.value)}}})])])]),t._v(" "),a("div",{staticClass:"col-md-6"},[a("div",{staticClass:"d-flex"},[a("label",[t._v("Solution:")]),t._v(" "),a("div",{staticClass:"table-field-wrapper"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.item.solution,expression:"row.item.solution"}],staticClass:"table-field",attrs:{placeholder:"Type solution here",name:"",id:"",cols:"30",rows:"7"},domProps:{value:e.item.solution},on:{input:function(a){a.target.composing||t.$set(e.item,"solution",a.target.value)}}})])])])])]}}],null,!0)})],1)})),0)])]),t._v(" "),a("div",{staticClass:"tab-pane fade",attrs:{id:"details",role:"tabpanel","aria-labelledby":"details-tab"}},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body"},[a("div",{staticClass:"row expended-table"},[a("div",{staticClass:"col-md-6"},[a("div",{staticClass:"d-flex"},[a("label",[t._v(" Report Name: ")]),t._v(" "),a("div",{staticClass:"table-field-wrapper"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.report_data.name,expression:"report_data.name"}],staticClass:"table-field",attrs:{type:"text",name:"name"},domProps:{value:t.report_data.name},on:{input:[function(e){e.target.composing||t.$set(t.report_data,"name",e.target.value)},t.updateReport]}})])]),t._v(" "),a("div",{staticClass:"d-flex"},[a("label",[t._v(" Customer: ")]),t._v(" "),a("div",{staticClass:"table-field-wrapper"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.report_data.customer_id,expression:"report_data.customer_id"}],staticClass:"table-field",attrs:{name:"customer_id",required:""},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.report_data,"customer_id",e.target.multiple?a:a[0])},t.updateReport]}},t._l(t.customers,(function(e,r){return a("option",{key:r,domProps:{value:e.id}},[t._v(t._s(e.name))])})),0)])]),t._v(" "),a("div",{staticClass:"d-flex"},[a("label",[t._v(" Report Date: ")]),t._v(" "),a("div",{staticClass:"table-field-wrapper"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.report_data.date,expression:"report_data.date"}],staticClass:"table-field",attrs:{required:"",type:"date",id:"report-date",name:"date"},domProps:{value:t.report_data.date},on:{input:[function(e){e.target.composing||t.$set(t.report_data,"date",e.target.value)},t.updateReport]}})])])]),t._v(" "),a("div",{staticClass:"col-md-12"},[a("label",[t._v(" Report Summary: ")]),t._v(" "),a("div",{staticClass:"table-field-wrapper"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.report_data.summary,expression:"report_data.summary"}],staticClass:"table-field",staticStyle:{resize:"vertical"},attrs:{name:"summary",id:"report-summary",placeholder:"write summary here",cols:"30",rows:"10"},domProps:{value:t.report_data.summary},on:{input:[function(e){e.target.composing||t.$set(t.report_data,"summary",e.target.value)},t.updateReport]}})])])])])])])])]):t._e()])]),t._v(" "),a("b-modal",{attrs:{centered:""},scopedSlots:t._u([{key:"modal-header",fn:function(e){var r=e.close;return[a("h5",[t._v("Are you sure?")]),t._v(" "),a("button",{staticClass:"close",attrs:{type:"button"},on:{click:r}},[a("i",{staticClass:"material-icons"},[t._v("close")])])]}},{key:"modal-footer",fn:function(e){var r=e.close;e.remove;return[a("b-button",{attrs:{variant:"secondary"},on:{click:function(t){return r()}}},[t._v("\n        Cancel\n      ")]),t._v(" "),a("b-button",{attrs:{variant:"danger"},on:{click:t.removeTarget}},[t._v("\n        Delete\n      ")])]}}]),model:{value:t.delete_modal.show,callback:function(e){t.$set(t.delete_modal,"show",e)},expression:"delete_modal.show"}},[t._v(" "),a("p",[t._v(t._s(t.delete_modal.message))])]),t._v(" "),a("b-modal",{attrs:{centered:""},scopedSlots:t._u([{key:"modal-header",fn:function(e){var r=e.close;return[a("h5",[t._v("Add Group")]),t._v(" "),a("button",{staticClass:"close",attrs:{type:"button"},on:{click:r}},[a("i",{staticClass:"material-icons"},[t._v("close")])])]}},{key:"modal-footer",fn:function(e){var r=e.close;e.remove;return[a("b-button",{attrs:{variant:"secondary"},on:{click:function(t){return r()}}},[t._v("\n        Cancel\n      ")]),t._v(" "),a("b-button",{attrs:{variant:"primary",type:"submit"},on:{click:t.addGroup}},[t._v("\n        Add\n      ")])]}}]),model:{value:t.add_group.show_modal,callback:function(e){t.$set(t.add_group,"show_modal",e)},expression:"add_group.show_modal"}},[t._v(" "),a("form",{attrs:{action:"",method:"post"}},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"select-group"}},[t._v("Select Group")]),t._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.add_group.group_id,expression:"add_group.group_id"}],staticClass:"form-control",attrs:{name:"",required:"",id:"select-group"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.add_group,"group_id",e.target.multiple?a:a[0])}}},t._l(t.availableGroups,(function(e,r){return a("option",{key:r,domProps:{value:e.id}},[t._v(t._s(e.name))])})),0)]),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"select-item"}},[t._v("Select item to add")]),t._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.add_group.item_id,expression:"add_group.item_id"}],staticClass:"form-control",attrs:{name:"",required:"",id:"select-item"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.add_group,"item_id",e.target.multiple?a:a[0])}}},t._l(t.groupItems,(function(e,r){return a("option",{key:r,domProps:{value:e.id}},[t._v(t._s(e.name))])})),0)])])])],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("ul",{staticClass:"nav nav-tabs mb-0",attrs:{id:"myTab",role:"tablist"}},[e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link active",attrs:{id:"report-tab","data-toggle":"tab",href:"#report",role:"tab","aria-controls":"report","aria-selected":"true"}},[this._v("Report")])]),this._v(" "),e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{id:"details-tab","data-toggle":"tab",href:"#details",role:"tab","aria-controls":"details","aria-selected":"false"}},[this._v("Details")])])])}],!1,null,"dfe4e2ae",null);e.default=y.exports},46:function(t,e,a){var r=a(70);"string"==typeof r&&(r=[[t.i,r,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};a(19)(r,s);r.locals&&(t.exports=r.locals)},69:function(t,e,a){"use strict";a(46)},70:function(t,e,a){(t.exports=a(18)(!1)).push([t.i,".b-table th[data-v-dfe4e2ae]:focus{outline-style:dashed}.expended-table[data-v-dfe4e2ae]{border:none}.expended-table label[data-v-dfe4e2ae]{flex-basis:25%;min-width:90px;padding:4px 10px;margin:0}.expended-table textarea[data-v-dfe4e2ae]{resize:none}.card[data-v-dfe4e2ae]{border-top-left-radius:0}.report-group[data-v-dfe4e2ae]:not(:last-child){margin-bottom:40px}#myTab[data-v-dfe4e2ae]{border-bottom:none}",""])}}]);